---
layout: post
title:  华为专家经验分享会
date:   2022-11-21 08:30:00 +0800
categories: [Localization]
excerpt: 华为专家经验分享会
tags:
  - 
  - 
  - 
  - 
---

华为MDC(mobile data center)是一个硬件平台，同时提供了一个运行平台和一整套无人驾驶程序。该运行平台运行在Ubuntu系统中，是从ros1优化得到的，和ros1的接口基本相同，实现了更好的通信、共享内存(提高了通信的效率)和DDS(提高了通信的实时性)的功能。该平台对应的无人驾驶程序，有闭源的ADS，另外为MDC平台提供了开源的demo。开源的部分使用了神经网络，但很多部分不是很好。而且考虑到这些demo主要作为展示使用，其代码中存在较多的bug。MDC附送的开源程序往往是闭源的ADS的旧版本，是不如百度的Apollo。

MDC的硬件很好，而且GPU是工业级的。NVIDIA的GPU主要是商业级的，如果用在工业上可能会存在一些问题。

Apollo的中间件是最好的，而且能和NVIDIA良好地适配，如果用在MDC上可能会存在驱动兼容性问题。

因为在使用中使用的消息类型一直在不断修改，但由于缺乏经验和于同行的交流，对消息、服务等类型的东西应该定义为哪些消息、每个消息应该包含哪些字段等没有正确的认识，也不知道自己做的对不对，有哪些缺点。所以向专家提问是否有一套标准的消息和服务等用于参考。MDC提供的程序中定义了一些消息等东西，但是这些主要是为demo定义的，而且场景也有很大区别。例如有关城市道路和地图的消息，可能包含车道线等信息，这些信息在矿山上并不需要甚至不存在，而且不同矿山的情况可能也不相同。因此标准和通用的地图格式并无必要。

传感器的故障检测完全应当用于多传感器融合模式的转换。

因为所用的机械激光雷达的故障率很高，维护成本在无人化中占比高，考虑减少用其它方案代替机械激光雷达，例如用红外摄像头、16线及以上的高分辨率的毫米波雷达替代激光雷达。就此向专家询问意见。民用车对成本敏感，因此一直考虑用减少传感器的方式降低成本。而且当前车上都会有司机和安全员，风险比较小。但矿用卡车对安全性敏感，不建议轻易去掉激光雷达。

就如何融合多传感器的问题向专家提问。专家表示，他们在实践时，在感知方案中，使用多种多个传感器，单个传感器用多种算法，使用不同的传感器融合组合和不同的融合算法和同和策略。这个

镭视的前融合方案开发的任务量很重，如果人手不充足，不建议开展。

华为的每一代自动驾驶程序，都同时会有大量C++程序和神经网络的程序。但从趋势上来看，神经网络是一直在加强的。

不同模块的任务量是随着项目进展而不断变化的。规划决策控制的问题主要集中在中后期。感知的问题主要集中在前期，标定的工作量只在项目的开始阶段。在车型稳定以后，标定工作一个人就能胜任。**根据人手和评估的工作量合理规划开发计划**

对于在车上使用的主机的意见，首先需要从工控机转向车规的域控制器。MDC的显卡性能好，对非标准化的模型支持不好；地平线支持号，但是域控不稳定，CPU也相对更差。对于小公司，更推荐NVIDIA的显卡，虽然缺少官方售后，但bug少、教程等资料廉价易得，服务成本更低。

在MDC的购买方面，有合作费和软件服务费等首次合作时额外支出的费用。合作费是按量分阶段报价，数量少3-5万，几百辆可以到一万。首批订单包含高昂的服务费，之后再购买无需再支付服务费。

ros1时延问题严重，传输大消息时效果更差。ros2的DDS极大改善了这一问题。Apollo开发的38rt分为商业版和开源版本。可以考虑把当前程序一直到其它更好的平台，但是需要评估移植成本。

关于边界提取、地图感知，建议激光雷达和视觉融合，并尽早引入神经网络训练。传统算法很快就会遇到corner case。

规划主要使用开源算法。

轨迹预测也可以引入深度学习的算法。当前预测目标是10秒。但速度在15-20km/h，实际上属于低速范围内，预测3秒已经基本够用。乘用车在50km/h每小时的速度下需要预测10秒，因为存在对向来车。预测10秒的要求下，神经网络要由于传统算法。

动力学模型的预测3秒。

训练时间上，一千小时才算入门，一万小时才算可用。

都工作了，还经常用“同学”这个称呼，这个习惯是怎么来的呢？

针对实际场景，除了算法方向，也可以采取一些管理动作达到目标，比如用插旗确定边界。

较小的物体，例如石头，可能只有三根雷达扫描线，可以采用累帧的方法增密点云，或融合多个雷达的点云。障碍物的表示方法上，应该用多边形或者栅格，尤其是石头等不规则的非通用障碍物。对于车辆和行人等，使用矩形可以更好地实现预测或计算角度。

毫米波雷达可以输出物体或者点云。对于物体可以给出速度。对于点云，识别人效果不好，需要做大物体的滤除。

红外相机价格较高，如果人手充足，最好买传感器自己做相机。120p的红外相机因为疫情期间抓人用，大量需求拉低了价格。

火山云、阿里云等云服务都可以做视觉追踪。

对于无人车底盘，矿卡的响应时间延迟是乘用车的3-4倍。当前加速度接口600-700毫秒时间过长。最好能有电机扭矩接口，直接控制电机。刹车时多阶段刹车，刹车的接口越多越好。

AEB风险平衡方面。对于乘用车，无障碍物时AEB，责任在AEB，有障碍物时AEB没有启动，责任在司机。因此乘用车更重视AEB的精确率(查准率)。但矿卡的安全性则要求更重视AEB的召回率(查全率)。

乘用车在定位失准时(rtk丢失)通常使用IMU等方式硬抗知道rtk信息正常。

神经网络的预备阶段，预运行阶段，需要大量采集数据。全部数据 ---> corner case ---> 创造数据

估计的周期：比如多个多种传感器同时感知，如果某个传感器没有感知到，就把数据保存下来作为问题数据。